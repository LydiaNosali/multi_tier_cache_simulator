import csv
import time
import pandas as pd
from numpy import random
from matplotlib import pyplot as plt

#
# unique_words = []
# tmsp = []
# name = []
#
# for i in range(50):
#     unique_words.append(i)
#
# # generate current timestamp in nanoseconds
# t = int(round(time.time_ns(), 0))
#
# # run for traffic_period minutes
# end = t + 2 * 60000000000
# print(end)
# while t < end:
#     # create requests on the words following a Zipf law
#     index = zip_f(1.2, len(unique_words))
#     while index >= len(unique_words):
#         index = zip_f(1.2, len(unique_words))
#     print(unique_words[index])
#     name.append(unique_words[index])
#     t_before = t
#     print('Before')
#     print(t)
#     t += t + int(round(random.exponential(0.2), 0))
#     print("int(round(random.exponential(0.1), 0))")
#     print(int(round(random.exponential(0.1) * 10e6, 0)))
#     tmsp.append(t)
from resources import NDN_PACKETS

for path in NDN_PACKETS:
    with open(path, encoding='utf8') as read_obj:
        csv_reader = csv.reader(read_obj, delimiter=',')
        data = list(csv_reader)

content = []
for line in data:
    content.append(line[2])

wfreq=[content.count(w) for w in content]

dicti = dict(zip(content, wfreq))

sorted_footballers_by_goals = sorted(dicti.items(), key=lambda x:x[1])


converted_dict = dict(sorted_footballers_by_goals)
print(converted_dict)

# converted_dict = {'497': 5, '440': 5, '474': 5, '496': 6, '485': 7, '432': 7, '447': 7, '416': 8, '479': 8, '370': 8, '473': 8, '489': 9, '456': 9, '455': 9, '492': 9, '457': 9, '449': 9, '464': 9, '402': 10, '452': 10, '403': 10, '467': 10, '373': 10, '482': 10, '425': 10, '393': 10, '392': 10, '450': 11, '499': 11, '483': 11, '462': 11, '435': 11, '498': 11, '480': 11, '378': 11, '387': 11, '465': 11, '469': 12, '318': 12, '427': 12, '476': 12, '451': 12, '381': 12, '470': 12, '426': 12, '448': 12, '424': 12, '463': 12, '459': 12, '481': 12, '495': 13, '363': 13, '354': 13, '391': 13, '430': 13, '461': 13, '436': 13, '348': 13, '344': 13, '400': 13, '472': 13, '442': 14, '401': 14, '490': 14, '487': 14, '446': 14, '458': 14, '361': 14, '395': 14, '494': 14, '484': 14, '336': 14, '443': 14, '359': 14, '417': 14, '382': 14, '471': 15, '386': 15, '385': 15, '431': 15, '380': 15, '262': 15, '383': 15, '377': 15, '406': 15, '410': 15, '366': 15, '405': 15, '407': 15, '441': 15, '412': 15, '419': 15, '335': 15, '414': 15, '423': 16, '439': 16, '477': 16, '422': 16, '339': 16, '358': 16, '428': 16, '413': 16, '304': 16, '408': 16, '418': 16, '265': 16, '323': 16, '488': 16, '411': 16, '468': 16, '372': 16, '399': 16, '454': 16, '491': 16, '388': 16, '297': 16, '352': 16, '248': 17, '328': 17, '486': 17, '475': 17, '415': 17, '438': 17, '394': 17, '404': 17, '295': 17, '460': 17, '303': 17, '308': 17, '364': 17, '437': 17, '256': 18, '276': 18, '362': 18, '466': 18, '320': 18, '355': 18, '375': 18, '433': 18, '374': 18, '409': 18, '376': 18, '420': 18, '371': 18, '349': 18, '244': 18, '356': 18, '274': 18, '367': 19, '313': 19, '350': 19, '445': 19, '389': 19, '292': 19, '329': 19, '341': 19, '331': 19, '310': 19, '281': 19, '267': 19, '444': 19, '369': 19, '325': 19, '340': 19, '493': 19, '368': 19, '390': 19, '397': 19, '429': 20, '305': 20, '216': 20, '360': 20, '421': 20, '315': 20, '384': 20, '379': 20, '342': 20, '351': 20, '181': 21, '273': 21, '227': 21, '322': 21, '478': 21, '263': 21, '334': 21, '333': 21, '327': 21, '332': 21, '345': 21, '343': 21, '453': 21, '337': 21, '285': 21, '287': 21, '434': 22, '346': 22, '232': 22, '296': 22, '240': 22, '326': 22, '251': 23, '365': 23, '261': 23, '291': 23, '396': 23, '279': 23, '246': 23, '324': 23, '286': 23, '294': 23, '353': 23, '306': 23, '271': 23, '398': 24, '243': 24, '255': 24, '228': 24, '357': 24, '338': 24, '280': 24, '309': 24, '290': 25, '258': 25, '266': 25, '259': 25, '192': 25, '347': 25, '317': 25, '321': 26, '311': 26, '312': 26, '252': 26, '299': 26, '238': 26, '288': 26, '204': 27, '277': 27, '239': 27, '215': 27, '272': 27, '302': 27, '275': 27, '301': 27, '226': 27, '269': 27, '330': 27, '198': 27, '268': 27, '307': 27, '257': 28, '298': 28, '220': 28, '284': 28, '206': 28, '179': 29, '293': 29, '229': 29, '316': 29, '314': 29, '189': 29, '191': 29, '187': 29, '282': 29, '235': 29, '242': 29, '270': 29, '247': 30, '283': 30, '241': 30, '201': 30, '224': 30, '319': 30, '203': 30, '260': 30, '249': 31, '253': 31, '278': 31, '214': 31, '300': 32, '289': 32, '230': 32, '236': 32, '194': 32, '205': 32, '196': 32, '254': 32, '234': 32, '217': 32, '264': 33, '233': 33, '221': 33, '207': 33, '185': 34, '211': 34, '225': 34, '202': 34, '210': 35, '231': 36, '245': 36, '173': 37, '212': 37, '213': 37, '222': 37, '170': 37, '200': 38, '165': 38, '177': 38, '175': 38, '190': 38, '223': 38, '164': 38, '218': 39, '250': 40, '186': 40, '193': 41, '209': 41, '183': 41, '237': 42, '208': 42, '152': 42, '178': 43, '163': 43, '195': 43, '219': 43, '199': 44, '176': 44, '128': 44, '182': 44, '180': 44, '151': 45, '144': 45, '169': 45, '188': 45, '174': 45, '168': 46, '184': 46, '161': 46, '171': 46, '143': 47, '136': 47, '159': 47, '140': 47, '147': 47, '160': 48, '149': 48, '158': 49, '167': 50, '154': 50, '157': 51, '172': 51, '156': 51, '166': 51, '145': 51, '135': 52, '197': 52, '162': 53, '146': 53, '131': 53, '139': 55, '142': 55, '134': 56, '126': 57, '148': 57, '133': 58, '155': 58, '124': 58, '132': 59, '150': 59, '125': 59, '127': 59, '130': 60, '153': 60, '122': 60, '112': 61, '115': 61, '119': 61, '103': 62, '123': 62, '113': 62, '120': 64, '138': 64, '99': 66, '129': 67, '117': 69, '92': 69, '141': 70, '94': 70, '121': 70, '118': 70, '102': 70, '137': 71, '116': 71, '110': 71, '106': 73, '114': 74, '105': 74, '96': 75, '104': 78, '107': 78, '109': 78, '90': 79, '108': 79, '82': 82, '101': 82, '95': 83, '111': 84, '88': 85, '89': 85, '84': 87, '100': 87, '97': 88, '93': 90, '98': 94, '91': 95, '85': 96, '79': 101, '86': 101, '83': 102, '81': 103, '77': 107, '78': 109, '67': 110, '71': 112, '73': 112, '74': 114, '87': 114, '69': 115, '70': 121, '68': 126, '80': 128, '75': 130, '72': 133, '76': 134, '66': 134, '65': 135, '59': 137, '64': 138, '63': 138, '62': 140, '60': 141, '61': 144, '52': 154, '55': 160, '51': 164, '57': 168, '50': 170, '56': 173, '53': 176, '58': 177, '54': 178, '49': 186, '48': 191, '46': 206, '45': 211, '44': 216, '42': 219, '39': 223, '47': 229, '43': 236, '41': 238, '40': 240, '38': 268, '36': 275, '37': 282, '32': 291, '35': 294, '33': 303, '34': 311, '29': 322, '31': 340, '30': 351, '28': 386, '27': 391, '25': 420, '26': 434, '24': 460, '23': 494, '22': 506, '20': 523, '21': 537, '19': 561, '18': 616, '17': 668, '16': 748, '15': 774, '14': 899, '13': 921, '12': 1032, '11': 1159, '10': 1267, '9': 1421, '8': 1685, '7': 1959, '6': 2409, '5': 2966, '4': 3785, '3': 5406, '2': 8688, '1': 20429}
# converted_dict = {'467': 26, '461': 35, '462': 35, '494': 36, '485': 36, '352': 38, '477': 38, '493': 39, '417': 40, '473': 40, '418': 40, '483': 41, '398': 41, '434': 41, '377': 42, '440': 42, '495': 42, '411': 42, '468': 43, '433': 43, '459': 43, '474': 43, '443': 43, '451': 44, '442': 44, '490': 44, '380': 44, '426': 45, '499': 45, '413': 45, '481': 45, '372': 45, '482': 45, '305': 46, '454': 46, '436': 46, '397': 47, '393': 47, '394': 47, '429': 47, '403': 47, '392': 47, '430': 48, '486': 48, '423': 48, '432': 48, '424': 48, '345': 48, '452': 48, '441': 48, '489': 48, '342': 49, '362': 49, '497': 49, '412': 49, '435': 49, '480': 49, '438': 49, '415': 49, '358': 49, '383': 49, '466': 49, '337': 49, '471': 49, '408': 50, '484': 50, '421': 50, '369': 50, '487': 50, '406': 50, '475': 50, '478': 50, '396': 50, '339': 50, '456': 51, '420': 51, '479': 51, '364': 51, '470': 51, '357': 51, '425': 51, '381': 51, '457': 51, '496': 51, '446': 51, '289': 51, '469': 51, '382': 51, '498': 51, '476': 52, '386': 52, '465': 52, '402': 52, '405': 52, '404': 52, '376': 52, '366': 52, '491': 52, '410': 53, '450': 53, '330': 53, '388': 53, '444': 53, '458': 53, '385': 53, '448': 53, '371': 54, '464': 54, '427': 54, '334': 54, '325': 54, '472': 54, '463': 54, '317': 54, '422': 54, '455': 54, '370': 55, '460': 55, '295': 55, '492': 55, '488': 55, '365': 55, '390': 56, '400': 56, '351': 56, '319': 56, '333': 56, '353': 56, '375': 56, '344': 56, '343': 57, '428': 57, '379': 57, '324': 57, '356': 57, '293': 57, '407': 57, '449': 57, '338': 58, '341': 58, '360': 59, '335': 59, '296': 59, '399': 59, '328': 59, '447': 59, '395': 59, '299': 59, '307': 59, '419': 60, '416': 60, '349': 60, '368': 60, '363': 60, '414': 60, '391': 61, '331': 61, '281': 61, '340': 61, '384': 61, '431': 62, '263': 62, '445': 62, '336': 63, '318': 63, '401': 63, '361': 64, '439': 64, '374': 64, '274': 64, '314': 64, '387': 64, '283': 64, '291': 64, '437': 65, '320': 65, '367': 65, '287': 65, '350': 66, '309': 66, '326': 66, '290': 66, '306': 66, '250': 66, '332': 67, '327': 67, '292': 67, '321': 67, '277': 67, '264': 67, '298': 68, '389': 68, '322': 68, '247': 68, '409': 68, '258': 68, '355': 68, '285': 69, '237': 69, '303': 69, '269': 69, '347': 69, '260': 69, '239': 69, '378': 70, '329': 70, '453': 70, '256': 70, '348': 70, '373': 70, '313': 70, '241': 70, '266': 71, '346': 71, '304': 71, '261': 71, '240': 71, '294': 71, '300': 71, '310': 71, '243': 72, '229': 72, '242': 72, '311': 72, '297': 72, '251': 72, '262': 72, '238': 72, '249': 72, '308': 73, '282': 73, '267': 74, '315': 74, '284': 74, '359': 74, '265': 74, '254': 75, '278': 76, '273': 76, '316': 76, '259': 77, '245': 77, '271': 77, '286': 77, '215': 77, '255': 77, '354': 78, '312': 79, '275': 80, '252': 80, '257': 81, '231': 81, '280': 81, '224': 81, '268': 81, '214': 82, '225': 82, '301': 82, '288': 83, '222': 83, '195': 83, '323': 83, '276': 83, '235': 84, '253': 85, '219': 85, '232': 85, '272': 85, '185': 86, '279': 86, '236': 86, '198': 86, '209': 87, '218': 87, '221': 87, '270': 88, '203': 88, '248': 88, '199': 89, '234': 89, '246': 89, '208': 90, '220': 90, '159': 90, '244': 91, '228': 91, '302': 91, '230': 92, '233': 92, '205': 93, '204': 93, '196': 94, '194': 94, '167': 94, '197': 94, '188': 94, '213': 95, '226': 95, '207': 95, '175': 95, '190': 95, '217': 95, '206': 96, '189': 96, '192': 96, '154': 96, '181': 97, '216': 97, '223': 98, '186': 98, '180': 98, '172': 98, '187': 100, '212': 100, '202': 100, '227': 100, '148': 101, '211': 102, '136': 103, '184': 103, '201': 103, '164': 104, '170': 104, '158': 105, '182': 106, '165': 106, '157': 108, '153': 108, '169': 109, '174': 109, '173': 109, '155': 109, '200': 111, '120': 111, '178': 112, '151': 113, '166': 113, '161': 113, '210': 114, '162': 114, '132': 114, '163': 114, '191': 114, '150': 114, '193': 115, '183': 116, '143': 116, '147': 117, '177': 118, '144': 118, '171': 120, '176': 120, '137': 121, '130': 121, '141': 122, '112': 122, '138': 122, '179': 122, '168': 123, '135': 124, '152': 125, '115': 126, '121': 126, '142': 128, '146': 130, '134': 133, '105': 133, '145': 133, '131': 134, '133': 134, '139': 135, '123': 135, '127': 135, '149': 135, '129': 137, '122': 138, '160': 138, '128': 141, '124': 141, '118': 142, '126': 143, '125': 143, '140': 144, '156': 144, '119': 145, '117': 146, '107': 150, '116': 150, '113': 150, '110': 151, '114': 152, '106': 156, '109': 157, '101': 158, '90': 159, '99': 161, '102': 161, '86': 162, '95': 162, '108': 163, '96': 163, '98': 165, '89': 165, '100': 169, '111': 170, '84': 170, '87': 175, '93': 176, '104': 176, '92': 177, '88': 177, '103': 180, '91': 180, '81': 180, '72': 182, '80': 184, '94': 184, '79': 189, '82': 191, '77': 192, '97': 200, '78': 202, '76': 202, '85': 208, '75': 209, '71': 209, '68': 211, '74': 212, '83': 216, '70': 218, '65': 221, '73': 227, '66': 228, '69': 228, '67': 230, '59': 230, '60': 232, '63': 234, '58': 241, '64': 243, '62': 243, '54': 247, '57': 251, '61': 253, '52': 267, '56': 276, '47': 289, '51': 293, '48': 294, '53': 301, '49': 305, '43': 306, '44': 308, '45': 312, '46': 312, '55': 313, '50': 318, '40': 320, '42': 330, '41': 334, '37': 346, '38': 353, '39': 355, '35': 369, '36': 394, '31': 395, '34': 397, '30': 404, '33': 404, '32': 438, '26': 442, '25': 443, '29': 446, '28': 463, '27': 465, '22': 509, '24': 509, '23': 535, '21': 555, '20': 577, '18': 626, '17': 666, '19': 670, '16': 722, '15': 744, '14': 798, '13': 817, '12': 897, '11': 993, '10': 1020, '9': 1143, '8': 1270, '7': 1340, '6': 1567, '5': 1710, '4': 2168, '3': 2664, '2': 3767, '1': 6417}

df = pd.DataFrame(data={'frequency': converted_dict.values()})
df.index = converted_dict.keys()

ax = df.plot(figsize=(17, 6), rot=0, xlabel='Time',
             ylabel='Data Frequency')
for c in ax.containers:
    labels = [v.get_height() if v.get_height() > 0 else '' for v in c]
    ax.bar_label(c, labels=labels, label_type='center')
plt.show()
# try:
#     plt.savefig(os.path.join(figure_folder, "write_number.png"))
# except:
#     print(f'Error trying to write into a new file in output folder "{figure_folder}"')
